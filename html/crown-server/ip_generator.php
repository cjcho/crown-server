<?

echo "\n" ;
echo "Let's get generatin'" ;
echo "\n" ;

$sql = "INSERT INTO `Servers` (`host_name`, `ip_address`, `info`, `operating_system`, `cpu_ram`, `comment`, `guest_name`)
VALUES" ;

$ips = array() ;
$startingIps = array('172.16.7.1', '172.16.10.1', '172.20.0.1', '172.21.0.1', '172.22.0.1') ;
$existingIps = array('172.16.16.2','172.16.7.202','172.21.0.10','172.22.0.10','172.16.23.31','172.16.7.42','172.16.7.41','172.22.0.11','172.21.0.11','172.21.0.100','172.21.0.101','172.21.0.102','172.21.0.103','172.21.0.104','172.21.070','172.16.7.3','172.16.7.4','172.21.0.21','172.22.0.20','172.16.17.204','172.22.0.21','172.16.7.39','172.16.7.40','172.21.0.30','172.22.0.30','172.16.17.205','172.21.0.33','172.21.0.34','172.16.18.7','172.21.0.31','172.16.7.31','172.16.16.17','172.16.7.77','172.16.7.12','172.16.7.14','172.21.0.41','172.16.7.43','172.16.7.65','172.16.7.','172.21.0.40','172.22.0.40','172.21.0.42','172.16.7.50','172.16.23.43','172.16.10.176','172.16.10.175','172.30.23.163','172.16.7.49','172.16.7.66','172.16.7.66','172.16.10.170','172.21.0.61','172.21.0.25','172.21.0.254','172.21.0.51','172.21.0.252','172.21.0.250','172.20.0.27','172.16.7.21','172.16.7.33','172.16.7.35','172.16.7.34','172.16.7.10','172.16.7.73','172.16.7.72','172.16.23.179','172.16.30.133','172.16.7.28','172.29.255.7','172.16.10.170','172.16.23.33','172.16.10.171','172.16.23.20','172.16.7.8','172.16.23.59','172.16.7.69');

foreach ($startingIps as $startingIp) {

	echo "Looping over ".$startingIp."\n" ;

	$ipBlocks = explode('.', $startingIp) ;

	$i = 1 ;
	$max = 255 ;
	while ($i <= 255) {

		$newIp = $ipBlocks[0].'.'.$ipBlocks[1].'.'.$ipBlocks[2].'.'.$i ;
		if(!in_array($newIp, $existingIps)){
			$ips[] = $newIp ;
			$sql .= "('','".$newIp."','','','','',''),\n" ;
			echo "Generated ".$newIp."\n" ;
		}
		else {
			echo $newIp." already exists.\n" ;
		}

		$i++;
	}

}

$sql = rtrim($sql, "\n,") ;
$sql .= ";" ; 

echo "\n" ;
echo "Found a total of ".count($ips)." new ip addresses.\n" ;

$fh = fopen('ips.sql', 'w') ;
fwrite($fh, $sql) ;
fclose($fh) ;

echo "SQL successfully written to ips.sql\n" ;

echo "\n" ;

?>